<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>åº—èˆ—ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ</title>
  <style>
    body { font-family: sans-serif; padding: 20px; max-width: 600px; margin: auto; }
    h1 { font-size: 28px; color: #2c3e50; text-align: center; margin-bottom: 30px; }
    label { display: block; margin-top: 20px; }
    select, textarea, input[type="text"] { width: 100%; padding: 8px; margin-top: 8px; box-sizing: border-box; }
    .hidden { display: none; }
    button { margin-top: 20px; padding: 10px 20px; background-color: #27ae60; color: white; border: none; cursor: pointer; }
    .thank-you { display: none; margin-top: 30px; text-align: center; }
  </style>
</head>
<body>

  <h1>åº—èˆ—ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ</h1>

  <form id="survey-form">
    <label>â‘  æ¥åº—é »åº¦ <span style="color:red;">*</span>
      <select id="visitFrequency" required>
        <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
        <option>åˆã‚ã¦æ¥åº—ã—ãŸ</option>
        <option>æœˆã«1å›æœªæº€</option>
        <option>æœˆã«1ã€œ2å›</option>
        <option>é€±ã«1å›ç¨‹åº¦</option>
        <option>é€±ã«2å›ä»¥ä¸Š</option>
      </select>
    </label>

    <label>â‘¡ å½“åº—ã‚’çŸ¥ã£ãŸãã£ã‹ã‘ <span style="color:red;">*</span>
      <select id="referralSource" required>
        <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
        <option>é€šã‚ŠãŒã‹ã‚Šã«è¦‹ã‹ã‘ãŸ</option>
        <option>å®¶æ—ãƒ»å‹äººã‹ã‚‰ã®ç´¹ä»‹</option>
        <option>SNS</option>
        <option>Googleã‚„é£Ÿã¹ãƒ­ã‚°</option>
        <option>ãƒãƒ©ã‚·ãƒ»åºƒå‘Š</option>
        <option>ãã®ä»–</option>
      </select>
    </label>

    <div id="referralOther" class="hidden">
      <label>ãã®ä»–ã®è©³ç´°
        <input type="text" id="referralOtherText">
      </label>
    </div>

    <label>â‘¢ å½“åº—ã®è‰¯ã‹ã£ãŸç‚¹ï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰
      <div>
        <label><input type="checkbox" name="goodPoints" value="ãƒ‘ãƒ³ã®å‘³ã‚„å“è³ª"> ãƒ‘ãƒ³ã®å‘³ã‚„å“è³ª</label><br>
        <label><input type="checkbox" name="goodPoints" value="å€¤æ®µè¨­å®š"> å€¤æ®µè¨­å®š</label><br>
        <label><input type="checkbox" name="goodPoints" value="å•†å“ã®ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³"> å•†å“ã®ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³</label><br>
        <label><input type="checkbox" name="goodPoints" value="æ¥å®¢æ…‹åº¦"> æ¥å®¢æ…‹åº¦</label><br>
        <label><input type="checkbox" name="goodPoints" value="åº—èˆ—ã®è¡›ç”Ÿç®¡ç†"> åº—èˆ—ã®è¡›ç”Ÿç®¡ç†</label><br>
        <label><input type="checkbox" name="goodPoints" value="åº—èˆ—ã®é›°å›²æ°—"> åº—èˆ—ã®é›°å›²æ°—</label><br>
        <label><input type="checkbox" id="goodOtherCheck" value="ãã®ä»–"> ãã®ä»–</label>
        <input type="text" id="goodOtherText" class="hidden" placeholder="ãã®ä»–ã®å†…å®¹ã‚’å…¥åŠ›">
      </div>
    </label>

    <label>â‘£ æ”¹å–„ã—ã¦ã»ã—ã„ç‚¹ï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰
      <div>
        <label><input type="checkbox" name="badPoints" value="ãƒ‘ãƒ³ã®å‘³ã‚„å“è³ª"> ãƒ‘ãƒ³ã®å‘³ã‚„å“è³ª</label><br>
        <label><input type="checkbox" name="badPoints" value="å€¤æ®µè¨­å®š"> å€¤æ®µè¨­å®š</label><br>
        <label><input type="checkbox" name="badPoints" value="å•†å“ã®ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³"> å•†å“ã®ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³</label><br>
        <label><input type="checkbox" name="badPoints" value="æ¥å®¢æ…‹åº¦"> æ¥å®¢æ…‹åº¦</label><br>
        <label><input type="checkbox" name="badPoints" value="åº—èˆ—ã®è¡›ç”Ÿç®¡ç†"> åº—èˆ—ã®è¡›ç”Ÿç®¡ç†</label><br>
        <label><input type="checkbox" name="badPoints" value="åº—èˆ—ã®é›°å›²æ°—"> åº—èˆ—ã®é›°å›²æ°—</label><br>
        <label><input type="checkbox" id="badOtherCheck" value="ãã®ä»–"> ãã®ä»–</label>
        <input type="text" id="badOtherText" class="hidden" placeholder="ãã®ä»–ã®å†…å®¹ã‚’å…¥åŠ›">
      </div>
    </label>

    <label>â‘¤ å½“åº—ã¸ã®ã”æ„Ÿæƒ³
      <textarea id="feedback" rows="4"></textarea>
    </label>

    <button type="submit">é€ä¿¡</button>
  </form>

  <div class="thank-you" id="thankYouMsg">
    <h2>ã”å›ç­”ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸï¼</h2>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-firestore-compat.js"></script>

  <script>
    // ğŸ”§ Firebaseè¨­å®šï¼ˆã‚ãªãŸã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæƒ…å ±ã«æ›¸ãæ›ãˆã¦ãã ã•ã„ï¼‰
    <script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.7.3/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.7.3/firebase-analytics.js";
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  const firebaseConfig = {
    apiKey: "AIzaSyBigATbxE2-_rz23xIXx8fk3VTCzgCOTvE",
    authDomain: "isekiya-survey.firebaseapp.com",
    projectId: "isekiya-survey",
    storageBucket: "isekiya-survey.firebasestorage.app",
    messagingSenderId: "289935528710",
    appId: "1:289935528710:web:283975a8366d483b514487",
    measurementId: "G-D12HF5HGVN"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);

    
    

    // FirebaseåˆæœŸåŒ–
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ 
    const form = document.getElementById("survey-form");
    const thankYou = document.getElementById("thankYouMsg");

    const referralSource = document.getElementById("referralSource");
    const referralOther = document.getElementById("referralOther");
    const referralOtherText = document.getElementById("referralOtherText");

    const goodOtherCheck = document.getElementById("goodOtherCheck");
    const goodOtherText = document.getElementById("goodOtherText");
    const badOtherCheck = document.getElementById("badOtherCheck");
    const badOtherText = document.getElementById("badOtherText");

    referralSource.addEventListener("change", () => {
      referralOther.classList.toggle("hidden", referralSource.value !== "ãã®ä»–");
    });

    goodOtherCheck.addEventListener("change", () => {
      goodOtherText.classList.toggle("hidden", !goodOtherCheck.checked);
    });

    badOtherCheck.addEventListener("change", () => {
      badOtherText.classList.toggle("hidden", !badOtherCheck.checked);
    });

    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      const goodPoints = Array.from(document.querySelectorAll('input[name="goodPoints"]:checked')).map(e => e.value);
      const badPoints = Array.from(document.querySelectorAll('input[name="badPoints"]:checked')).map(e => e.value);

      if (goodOtherCheck.checked) goodPoints.push(goodOtherText.value);
      if (badOtherCheck.checked) badPoints.push(badOtherText.value);

      const data = {
        visitFrequency: document.getElementById("visitFrequency").value,
        referralSource: referralSource.value,
        referralOther: referralOtherText.value,
        goodPoints: goodPoints,
        badPoints: badPoints,
        feedback: document.getElementById("feedback").value,
        timestamp: new Date()
      };

      try {
        await db.collection("surveyResponses").add(data);
        form.style.display = "none";
        thankYou.style.display = "block";
      } catch (err) {
        alert("é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸ: " + err.message);
      }
    });
  </script>

</body>
</html>
